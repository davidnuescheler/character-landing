{"version":3,"sources":["html.pre.js"],"names":["jquery","require","pre","context","document","content","$","defaultView","currentCollection","sections","body","childNodes","forEach","child","tagName","push","el","wrapAll","querySelectorAll","parentNode","removeChild","$sections","find","has","addClass","first","not","module","exports"],"mappings":"AAAA;;;;;;;;;;;AAWA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;AAEA;;;;;;;AAKA,SAASC,GAAT,CAAaC,OAAb,EAAsB;AACpB,QAAM;AAAEC,IAAAA;AAAF,MAAeD,OAAO,CAACE,OAA7B;AACA,QAAMC,CAAC,GAAGN,MAAM,CAACI,QAAQ,CAACG,WAAV,CAAhB;AAEA;;AACA,MAAIC,iBAAiB,GAAG,EAAxB;AACA,QAAMC,QAAQ,GAAG,EAAjB;AAEAL,EAAAA,QAAQ,CAACM,IAAT,CAAcC,UAAd,CAAyBC,OAAzB,CAAkCC,KAAD,IAAW;AAC1C,QAAIA,KAAK,CAACC,OAAN,KAAkB,IAAtB,EAA4B;AAC1BL,MAAAA,QAAQ,CAACM,IAAT,CAAcP,iBAAd;AACAA,MAAAA,iBAAiB,GAAG,EAApB;AACD,KAHD,MAGO;AACLA,MAAAA,iBAAiB,CAACO,IAAlB,CAAuBF,KAAvB;AACD;AACF,GAPD;AASAJ,EAAAA,QAAQ,CAACM,IAAT,CAAcP,iBAAd;AACAC,EAAAA,QAAQ,CAACG,OAAT,CAAkBI,EAAD,IAAQ;AACvBV,IAAAA,CAAC,CAACU,EAAD,CAAD,CAAMC,OAAN,CAAc,6BAAd;AACD,GAFD;AAIAb,EAAAA,QAAQ,CAACc,gBAAT,CAA0B,SAA1B,EAAqCN,OAArC,CAA8CI,EAAD,IAAQ;AACnDA,IAAAA,EAAE,CAACG,UAAH,CAAcC,WAAd,CAA0BJ,EAA1B;AACD,GAFD;AAGA;;AAEA,QAAMK,SAAS,GAAGf,CAAC,CAACF,QAAD,CAAD,CAAYkB,IAAZ,CAAiB,aAAjB,CAAlB,CA3BoB,CA6BpB;;AACAD,EAAAA,SAAS,CACNE,GADH,CACO,MADP,EAEGC,QAFH,CAEY,OAFZ,EA9BoB,CAkCpB;;AACAH,EAAAA,SAAS,CACNI,KADH,GAEGF,GAFH,CAEO,mBAFP,EAGGC,QAHH,CAGY,OAHZ,EAIGF,IAJH,CAIQ,kBAJR,EAKGL,OALH,CAKW,4BALX,EAnCoB,CA0CpB;;AACAI,EAAAA,SAAS,CACNK,GADH,CACO,QADP,EAEGA,GAFH,CAEO,QAFP,EAGGF,QAHH,CAGY,SAHZ;AAID;;AAEDG,MAAM,CAACC,OAAP,CAAe1B,GAAf,GAAqBA,GAArB","file":"html.pre.js","sourceRoot":"../pages/master/src","sourcesContent":["/*\n * Copyright 2019 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nconst jquery = require('jquery');\n\n/**\n * The 'pre' function that is executed before the HTML is rendered\n * @param context The current context of processing pipeline\n * @param context.content The content\n */\nfunction pre(context) {\n  const { document } = context.content;\n  const $ = jquery(document.defaultView);\n\n  /* workaround until sections in document are fixed via PR on pipeline */\n  let currentCollection = [];\n  const sections = [];\n\n  document.body.childNodes.forEach((child) => {\n    if (child.tagName === 'HR') {\n      sections.push(currentCollection);\n      currentCollection = [];\n    } else {\n      currentCollection.push(child);\n    }\n  });\n\n  sections.push(currentCollection);\n  sections.forEach((el) => {\n    $(el).wrapAll('<div class=\"section\"></div>');\n  });\n\n  document.querySelectorAll('body>hr').forEach((el) => {\n    el.parentNode.removeChild(el);\n  });\n  /* end of workaround */\n\n  const $sections = $(document).find('div.section');\n\n  // sections with an image immediatly after the section break\n  $sections\n    .has('>img')\n    .addClass('image');\n\n  // first section has a starting image: add title class and wrap all subsequent items inside a div\n  $sections\n    .first()\n    .has('p:first-child>img')\n    .addClass('title')\n    .find(':nth-child(1n+2)')\n    .wrapAll('<div class=\"header\"></div>');\n\n  // sections without image and title class gets a default class\n  $sections\n    .not('.image')\n    .not('.title')\n    .addClass('default');\n}\n\nmodule.exports.pre = pre;\n"]}